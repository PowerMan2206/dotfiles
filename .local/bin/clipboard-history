#!/bin/bash

# basically clipboard history
# read wl-paste and if it's different than before, put it in a file
# made by PowerMan2206

clip=$(wl-paste)
bad='PNG'

case $1 in
	--clear | -c )
		echo "" > ~/.clipboard-history
		echo "Clipboard history file cleared"
		echo ""
		exit
		;;
esac

while true; do
	clip=$(wl-paste)
	date=$(date +"%Y-%m-%dT%H:%M:%S")
	if [[ "$clip" == *"$bad"* ]]; then
		echo "$date Image in clipboard, skipping..."
	else :
		case $clip in
			$oldclip )
				echo "$date Clipboard is the same, skipping..."
				;;
			* )
				echo "$date Clipboard update, appending to file..."
				wl-paste >> ~/.clipboard-history
				oldclip=$clip
				;;
		esac
	fi
	sleep 1
done
